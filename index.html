<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Map</title>
    <style>
        html, body, #map {
            height: 800px;
            width: 100%;
            margin: 0px;
            padding: 0px
        }
    </style>
    <script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyAgPbCe65T8HEheeIjBFwHS3u1f-hRm7AQ"></script>
</head>
<body>
    <div id="map"></div>
	

	
    <script>
        // ORIGIN
		
		var name = window.prompt("Enter Client Postcode: ");
		
        var locations = [
			['Craig Dowey', 'DN11', 'https://www.google.co.uk', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['George', 'WN1', 'https://www.google.co.uk', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Burns', 'TQ12 3AF', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Dan B', 'IP5 1JJ', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Rahul', 'CV6', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Chloe', 'CB6', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Danny', 'MK16 8DS', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['NTA', 'ME4 4RH', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Billson', 'DY5', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Billson', 'B15 1AU', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Billson', 'CH65 9EH', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Billson', 'SO51 5BJ', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png'],
			['Mum', 'S80 4UP', 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png']
        ];
		
		locations.push(['Client', name, 'https://www.google.co.uk/', 'https://maps.google.com/mapfiles/kml/shapes/ranger_station.png'])

        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 1,
            center: new google.maps.LatLng(55.3781, 3.4360),
            mapTypeId: google.maps.MapTypeId.TERRAIN

        });

        var infowindow = new google.maps.InfoWindow();
        var geocoder = new google.maps.Geocoder();
        var bounds = new google.maps.LatLngBounds();
        var marker, i;

		rateAddresses();

		async function rateAddresses() {
			for (i = 0; i < locations.length; i++) 
			{
				codeAddress(locations[i]);
				await new Promise(r => setTimeout(r, 250));
			}
		}

        function codeAddress(location) {
            geocoder.geocode({
                'address': location[1]
            }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
//					map.setCenter(name);
						var marker = new google.maps.Marker({
							map: map,
							title: location[1],
							url: locations[2],
							icon: location[3],
							position: results[0].geometry.location, 
						});
                    bounds.extend(marker.getPosition());
                    map.fitBounds(bounds);

                    google.maps.event.addListener(marker, 'dblclick', function () {
                        window.location.href = this.url;
                    });

                    google.maps.event.addListener(marker, 'click', (function (marker, location) {
                        return function () {
                            infowindow.setContent(location[0]);
                            infowindow.open(map, marker);
                        };
                    })(marker, location));

					google.maps.event.addListener(marker,'click',function(e) {
						map.setZoom(10);
						map.setCenter(e.latLng);
					});
                }   else  {
                    console.log("Geocode was not successful for the following reason: " + status);
                }
				
            }); 
        }
    </script>
</body>
</html>
